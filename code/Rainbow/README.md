This is copied and modified from https://github.com/Kaixhin/Rainbow.

I verified the performance.